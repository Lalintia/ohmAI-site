<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Chatbot Demo</title>
  <meta name="description" content="Demo page for testing AI Chatbot with n8n webhook integration." />

  <!-- Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Base styles -->
  <style>
    :root {
      font-family: 'Sora', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Noto Sans Thai', 'Noto Sans', sans-serif;

      /* n8n/chat theme variables (work inside shadow DOM) */
      --chat--font-family: 'Sora', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Noto Sans Thai', 'Noto Sans', sans-serif;
      --n8n-font-family: var(--chat--font-family);
      --chat--input-border-radius: 12px;
      --chat--input-padding: 12px 14px;
      --chat--input-min-height: 48px;
    }

    body {
      margin: 0;
      background-color: #0b0b0f;
      background-image: radial-gradient(circle at top, #1a1a2e 0%, #0b0b0f 50%);
      color: #e6e6f0;
      line-height: 1.6;
    }

    header { padding: 80px 24px 40px; text-align: center; }
    h1 { font-size: 52px; font-weight: 700; margin: 0 0 16px; letter-spacing: 1px; background: -webkit-linear-gradient(45deg, #ffffff, #9ecbff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .lead { margin: 0; opacity: .8; font-size: 1.1rem; }

    .cta { margin: 32px auto 0; display: inline-block; padding: 14px 24px; border-radius: 12px; background: #4a4a6a; color: #fff; font-weight: 600; text-decoration: none; transition: transform .2s ease, background .2s ease; }
    .cta:hover { transform: scale(1.05); background: #5a5a8a; }

    .grid { display: grid; gap: 24px; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); padding: 28px; max-width: 1000px; margin: 0 auto; }
    .card { background: rgba(21,21,29,.6); border: 1px solid #2a2a3f; border-radius: 16px; padding: 24px; backdrop-filter: blur(10px); box-shadow: 0 4px 20px rgba(0,0,0,.2); }
    .card h3 { margin: 0 0 12px; font-size: 1.25rem; font-weight: 600; color: #fff; }

    footer { text-align: center; padding: 40px 12px 56px; opacity: .6; }
    a { color: #9ecbff; text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>

  <!-- n8n chat styles (pinned version) -->
  <link href="https://cdn.jsdelivr.net/npm/@n8n/chat@0.27.1/dist/style.css" rel="stylesheet"/>
</head>
<body>
  <header>
    <h1>AI Chatbot Demo</h1>
    <p class="lead">หน้านี้ถูกสร้างขึ้นเพื่อทดสอบและสาธิตการทำงานของระบบ AI Chatbot</p>
    <a id="cta-open-chat" class="cta" href="#" aria-label="Open Chatbot">เริ่มทดสอบ</a>
  </header>

  <section class="grid">
    <div class="card">
      <h3>วัตถุประสงค์</h3>
      <p>เพจนี้ใช้สำหรับทดสอบระบบ AI Chatbot และแสดงตัวอย่างการโต้ตอบ เพื่อให้ผู้ใช้งานหรือผู้บริหารเข้าใจรูปแบบการทำงานจริง</p>
    </div>
    <div class="card">
      <h3>สิ่งที่สามารถทดสอบได้</h3>
      <ul>
        <li>ถาม-ตอบ ข้อมูลบริการ/ผลิตภัณฑ์</li>
        <li>ดูตัวอย่าง Workflow อัตโนมัติ</li>
        <li>ทดสอบประสบการณ์ใช้งานจริงของผู้ใช้</li>
      </ul>
    </div>
    <div class="card">
      <h3 id="subscribe">หมายเหตุ</h3>
      <p>เพจนี้เป็นเพียงการสาธิต (Demo) ไม่ใช่ระบบใช้งานจริง</p>
    </div>
  </section>

  <footer>© <span id="y"></span> AI Chatbot Demo — Built on Render</footer>
  <script>document.getElementById('y').textContent = new Date().getFullYear();</script>

  <script type="module">
    import { createChat } from 'https://cdn.jsdelivr.net/npm/@n8n/chat@0.27.1/dist/chat.bundle.es.js';

    // สร้างแชท (float button ขวาล่าง)
    const chat = createChat({
      webhookUrl: 'https://dev.ohmai.me/webhook/fd4cedb7-6d0f-4d41-b539-798ea05ad81e/chat',
      initialMessages: [
        'ยินดีต้อนรับสู่ AI Chatbot Demo!',
        'คุณสามารถลองสอบถามข้อมูล หรือตัวอย่างบริการได้ที่นี่.',
        'เริ่มต้นพิมพ์ข้อความเพื่อทดสอบการโต้ตอบ',
      ],
      i18n: {
        th: {
          title: 'นี่คือ Chatbot ทดสอบ',
          subtitle: 'เดโมสำหรับลูกค้าหรือผู้บริหาร',
          inputPlaceholder: 'พิมพ์ข้อความเพื่อทดสอบ...',
        },
      },
      defaultLanguage: 'th',
    });

    // ฟังก์ชันเปิด popup แชทเมื่อกดปุ่ม CTA
    function openChatPopup() {
      // 1) ถ้าไลบรารีมีเมธอด open ให้เรียกใช้
      if (chat && typeof chat.open === 'function') {
        chat.open();
        return;
      }
      // 2) ถ้าไม่มี ให้พยายามคลิกปุ่ม toggle ของวิดเจ็ต
      const possibleSelectors = [
        'button[aria-label="Open chat"]',
        '.n8n-chat-button',
        '.n8n-chat__toggle',
      ];
      for (const sel of possibleSelectors) {
        const btn = document.querySelector(sel);
        if (btn) { btn.click(); return; }
      }
    }

    // bind ปุ่ม CTA
    const cta = document.getElementById('cta-open-chat');
    cta.addEventListener('click', (e) => { e.preventDefault(); openChatPopup(); });
  </script>
</body>
</html>
